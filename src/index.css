@import "./styles/tokens.css";

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ===== Base ===== */
html, body {
  overflow-x: hidden;
  touch-action: pan-y;
}

/* ============================
   Utilities
   ============================ */
@layer utilities {
  .mobile-only { @apply block md:hidden; }
  .tablet-only { @apply hidden sm:block lg:hidden; }
  .desktop-only { @apply hidden lg:block; }
  .not-mobile { @apply hidden sm:block; }

  .responsive-grid { @apply grid gap-3 grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4; }
  .responsive-padding { @apply p-3 sm:p-4 md:p-5 lg:p-6; }
  .responsive-text { @apply text-sm sm:text-base md:text-base lg:text-lg; }

  .container-mobile { @apply w-full px-4; }
  .container-tablet { @apply w-full max-w-3xl mx-auto px-6; }
  .container-desktop { @apply w-full max-w-6xl mx-auto px-8; }
  .container-responsive { @apply container-mobile sm:container-tablet lg:container-desktop; }

  .border-safe { @apply border-[1.5px] border-gray-300 dark:border-gray-600; }
  .card-border { @apply border-[1.5px] border-gray-300 dark:border-gray-600 rounded-lg; }
  .button-border { @apply border-[1.5px] border-gray-400 dark:border-gray-500 rounded-md; }
  .border-strong { @apply border-[1.5px] border-gray-400 dark:border-gray-500; }
  .border-accent { @apply border-[1.5px] border-orange-300 dark:border-orange-600; }

  /* iPad sidebar helpers */
  .sidebar-ipad-overlay {
    z-index: 50;
    position: fixed;
    background: rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(2px);
  }
  .sidebar-ipad-default-collapsed { width: var(--sidebar-width-icon); }
  .sidebar-ipad-overlay-expanded {
    position: fixed; z-index: 60; left: 0; top: 0; height: 100vh; width: var(--sidebar-width);
    background: white; border-right: 1px solid theme('colors.border');
    box-shadow: 0 10px 40px rgba(0,0,0,.1);
  }
  @media (min-width: 641px) and (max-width: 1024px) {
    .sidebar-content-no-shift { margin-left: 0 !important; padding-left: 0 !important; transition: none !important; }
    .sidebar-overlay-backdrop {
      position: fixed; inset: 0; background: rgba(0,0,0,.3); z-index: 55; backdrop-filter: blur(2px);
    }
  }
}

/* ============================
   Components (Dialog, Cards, etc.)
   ============================ */
@layer components {
  /* --- DIALOG: pola centering konsisten --- 
     Rekomendasi pakai overlay + inner panel:
     <DialogContent class="dialog-overlay-center">
       <div class="dialog-panel dialog-responsive">â€¦</div>
     </DialogContent>
  */

  /* Overlay grid centering (paling stabil di semua device) */
  .dialog-overlay-center {
    @apply fixed inset-0 grid place-items-center p-4 sm:p-6;
    z-index: 70; /* > sidebar overlay */
  }

  /* Panel dalam overlay (apply bg/border/rounded di sini) */
  .dialog-panel {
    @apply w-full max-w-lg bg-white rounded-xl shadow-xl;
  }

  /* Alternatif: fixed + translate (jika tidak pakai inner panel)
     NOTE: jangan pakai margin (my-*) di sini */
  .dialog-content {
    @apply fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2
           w-full max-w-lg bg-white rounded-xl shadow-xl;
    z-index: 70;
  }

  /* Area scroll di DALAM panel; pakai dvh supaya stabil di iOS Safari */
  .dialog-responsive {
    @apply overflow-y-auto overflow-x-hidden;
    max-height: 85dvh;
    padding: 1rem;
  }

  /* Breakpoints (padding & tinggi) */
  @media (max-width: 640px) {
    .dialog-panel { @apply max-w-none; }
    .dialog-content { @apply max-w-none; }
    .dialog-responsive { max-height: 95dvh; padding: 1rem; }
  }
  @media (min-width: 641px) and (max-width: 768px) {
    .dialog-panel { @apply max-w-xl; }
    .dialog-content { @apply max-w-xl; }
    .dialog-responsive { max-height: 85dvh; padding: 1.5rem; }
  }
  @media (min-width: 769px) and (max-width: 1024px) {
    .dialog-panel { @apply max-w-2xl; }
    .dialog-content { @apply max-w-2xl; }
    .dialog-responsive { max-height: 80dvh; padding: 1.5rem; }
  }
  @media (min-width: 1025px) {
    .dialog-panel { @apply max-w-3xl; }
    .dialog-content { @apply max-w-3xl; }
    .dialog-responsive { max-height: 85dvh; padding: 2rem; }
  }

  /* Wrapper tambahan (opsional) */
  .modal-wrapper { @apply p-4 sm:p-5 md:p-6 lg:p-8; }

  /* Inner form panels (gunakan di DALAM .dialog-panel / .dialog-content) */
  .form-dialog {
    @apply w-full max-w-[500px] bg-white border border-gray-200 rounded-xl shadow-xl p-6 sm:p-8;
  }
  @media (max-width: 640px) { .form-dialog { @apply max-w-none p-3; } }
  @media (min-width: 641px) and (max-width: 768px) { .form-dialog { @apply max-w-lg p-5; } }
  @media (min-width: 769px) and (max-width: 1024px) { .form-dialog { @apply max-w-xl p-6; } }

  .form-dialog-large {
    @apply w-full max-w-[800px] bg-white border border-gray-200 rounded-xl shadow-xl mx-auto p-6 sm:p-8;
  }
  @media (max-width: 640px) { .form-dialog-large { @apply max-w-none p-3; } }
  @media (min-width: 641px) and (max-width: 768px) { .form-dialog-large { @apply max-w-2xl p-5; } }
  @media (min-width: 769px) and (max-width: 1024px) { .form-dialog-large { @apply max-w-3xl p-6; } }
  @media (min-width: 1025px) { .form-dialog-large { @apply max-w-4xl p-8; } }

  /* Cards & stats */
  .card-responsive { @apply w-full; }
  .card-stats { @apply p-3 sm:p-4 md:p-5 lg:p-6; }
  .card-content-responsive { @apply p-3 sm:p-4 md:p-5; }
  .card-header-responsive { @apply px-3 py-2 sm:px-4 sm:py-3 md:px-5 md:py-4; }

  .card-title-responsive { @apply text-sm sm:text-base md:text-lg font-semibold; }
  .card-value-responsive { @apply text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold; }
  .card-label-responsive { @apply text-xs sm:text-sm text-gray-600; }
  .card-description-responsive { @apply text-xs sm:text-sm text-gray-500; }

  .card-icon-responsive { @apply w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6; }
  .card-icon-container-responsive { @apply w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-lg flex items-center justify-center; }

  .stats-grid-responsive {
    @apply grid gap-3 sm:gap-4 md:gap-4 lg:gap-6;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  }
  @media (max-width: 640px) {
    .stats-grid-responsive { @apply grid-cols-1 gap-3; grid-template-columns: 1fr; }
  }
  @media (min-width: 641px) and (max-width: 768px) {
    .stats-grid-responsive { @apply grid-cols-2 gap-3; grid-template-columns: repeat(2, 1fr); }
  }
  @media (min-width: 769px) and (max-width: 1024px) {
    .stats-grid-responsive { @apply grid-cols-2 gap-4; grid-template-columns: repeat(2, minmax(250px, 1fr)); }
  }
  @media (min-width: 1025px) and (max-width: 1280px) {
    .stats-grid-responsive { @apply grid-cols-3 gap-5; grid-template-columns: repeat(3, 1fr); }
  }
  @media (min-width: 1281px) {
    .stats-grid-responsive { @apply grid-cols-4 gap-6; grid-template-columns: repeat(4, 1fr); }
  }

  .header-responsive { @apply px-4 py-3 sm:px-6 sm:py-4 md:px-8 md:py-5; }
  .header-title-responsive { @apply text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold; }
  .header-subtitle-responsive { @apply text-sm sm:text-base text-gray-600; }

  .button-group-responsive { @apply flex flex-wrap gap-2 sm:gap-3 md:gap-4; }
  .text-overflow-safe { @apply break-words overflow-hidden; word-wrap: break-word; overflow-wrap: break-word; }

  /* Dialog body, header, footer padding classes */
  .dialog-body {
    @apply flex-1 overflow-y-auto overflow-x-hidden p-6;
    max-height: calc(90dvh - 8rem); /* Reserve space for header/footer */
  }
  
  .dialog-header-pad {
    @apply px-6 py-4 border-b border-gray-200;
  }
  
  .dialog-footer-pad {
    @apply px-6 py-4 border-t border-gray-200;
  }
  
  /* Mobile adjustments */
  @media (max-width: 640px) {
    .dialog-body { @apply p-4; }
    .dialog-header-pad { @apply px-4 py-3; }
    .dialog-footer-pad { @apply px-4 py-3; }
  }
}
